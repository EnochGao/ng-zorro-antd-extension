import{b as D,c as u}from"./chunk-ZNLYLGZP.js";import{e as F,n as S}from"./chunk-IIKYZ7T6.js";import{d as v}from"./chunk-U24ICDSZ.js";import{b as C}from"./chunk-UEO2LBLP.js";import{b as y,g as f}from"./chunk-752J3DYG.js";import{Ba as l,Fb as x,Gb as T,Hb as g,La as P,X as c,ca as d,f as z,ha as o,l as n,ma as b,na as h}from"./chunk-OGFJLPPA.js";import{a as m}from"./chunk-UKNGC2Y4.js";var O="nzxTableAdaptor",Q="NZX_TABLE_ADAPTOR",i=class a{set queryParams(r){this._queryParams=r}get queryParams(){return this._queryParams}constructor(r){this.router=r,this._nzModuleName=O,this.enableCache=!1,this.dateFormat="yyyy-MM-dd",this.customFormateOutFn=e=>{for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(y(e[t])&&(e[t]=f(e[t],this.dateFormat)),Array.isArray(e[t])&&(e[t]=e[t].map(s=>y(s)?f(s,this.dateFormat):s)));return C(e)},this.nzxQueryParams=new l,this.nzxQueryCacheQueryParams=new l,this._queryParams={},this.destroy$=new z,this.nzxConfigService=o(D),this.nzTable=o(S),this.nzTableDataService=o(F),setTimeout(()=>{this.nzTable.nzShowSizeChanger=!0,this.nzTable.nzFrontPagination=!1,this.nzTableDataService.updateFrontPagination(!1)},0),this.nzTable.nzQueryParams.pipe(c(this.destroy$)).subscribe(e=>{this.nzTableQueryParams=e,this.emit()}),this.nzTable.nzCurrentPageDataChange.pipe(c(this.destroy$)).subscribe(e=>{if(this.nzTable.nzData.length===0&&this.nzTable.nzTotal>0){let t=this.nzTable.nzPageIndex-1;this.nzTable.onPageIndexChange(t)}})}ngOnInit(){if(this.nzTableDataService.updatePageIndex(1),this.nzTableDataService.updatePageSize(10),this.enableCache){let r=sessionStorage.getItem(Q+this.router.url);if(r){let e=JSON.parse(r);this.nzTableDataService.updatePageIndex(e.pageIndex),this.nzTableDataService.updatePageSize(e.pageSize),this.nzxQueryCacheQueryParams.emit(e)}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}refresh(r){r?this.emit():this.nzTable.nzPageIndex===1?this.emit():this.nzTableDataService.updatePageIndex(1)}reset(r){if(r)this._queryParams=r;else for(let e in this._queryParams)Object.prototype.hasOwnProperty.call(this._queryParams,e)&&(this._queryParams[e]="");this.nzTable.nzPageIndex===1?this.emit():this.nzTableDataService.updatePageIndex(1)}emit(){let r=m(m({},this._queryParams),this.nzTableQueryParams);this.enableCache&&sessionStorage.setItem(Q+this.router.url,JSON.stringify(r)),this.nzxQueryParams.emit(this.customFormateOutFn(r))}static{this.\u0275fac=function(e){return new(e||a)(P(v))}}static{this.\u0275dir=h({type:a,selectors:[["nz-table","nzxTableAdaptor",""]],inputs:{queryParams:"queryParams",enableCache:"enableCache",dateFormat:"dateFormat",customFormateOutFn:"customFormateOutFn"},outputs:{nzxQueryParams:"nzxQueryParams",nzxQueryCacheQueryParams:"nzxQueryCacheQueryParams"},exportAs:["NzxTableAdaptor"]})}};n([u()],i.prototype,"enableCache",void 0);n([u()],i.prototype,"dateFormat",void 0);n([u()],i.prototype,"customFormateOutFn",void 0);var Z=(()=>{class a{static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275mod=b({type:a})}static{this.\u0275inj=d({})}}return a})();var K=(()=>{class a{constructor(){this.list=[],this.loading=!1,this.nzTotal=0}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275dir=h({type:a,viewQuery:function(t,s){if(t&1&&x(i,5),t&2){let p;T(p=g())&&(s.nzxTableAdaptorRef=p.first)}}})}}return a})();export{i as a,Z as b,K as c};
