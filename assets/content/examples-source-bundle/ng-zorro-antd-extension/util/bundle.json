[{"path":"util/util.component.html","content":"<nz-card nzTitle=\"更新控件状态（updateControlStatus）\">\n  <form nz-form [formGroup]=\"form\">\n    <nz-form-item>\n      <nz-form-label [nzSpan]=\"7\" nzRequired>Username</nz-form-label>\n      <nz-form-control [nzSpan]=\"12\" nzErrorTip=\"必填\">\n        <input nz-input formControlName=\"userName\" />\n      </nz-form-control>\n    </nz-form-item>\n    <div nz-row>\n      <div nz-col nzPush=\"6\" [nzSpan]=\"12\">\n        <h4>address</h4>\n      </div>\n    </div>\n\n    <ng-container formGroupName=\"address\">\n      <nz-form-item>\n        <nz-form-label [nzSpan]=\"7\" nzRequired>street</nz-form-label>\n        <nz-form-control [nzSpan]=\"12\" nzErrorTip=\"必填\">\n          <input nz-input formControlName=\"street\" />\n        </nz-form-control>\n      </nz-form-item>\n      <nz-form-item>\n        <nz-form-label [nzSpan]=\"7\" nzRequired>city</nz-form-label>\n        <nz-form-control [nzSpan]=\"12\" nzErrorTip=\"必填\">\n          <input nz-input formControlName=\"city\" />\n        </nz-form-control>\n      </nz-form-item>\n    </ng-container>\n\n    <div nz-row>\n      <div nz-col nzPush=\"6\" [nzSpan]=\"12\">\n        <h4>\n          aliases formArray\n          <button nz-button type=\"button\" (click)=\"addAlias()\">+ Add</button>\n        </h4>\n      </div>\n    </div>\n\n    <ng-container formArrayName=\"aliases\">\n      <nz-form-item *ngFor=\"let alias of aliases.controls; let i = index\">\n        <nz-form-label [nzSpan]=\"7\" [nzRequired]=\"!!!i\" [nzNoColon]=\"!!i\">\n          <span *ngIf=\"!i\"> Alias </span>\n        </nz-form-label>\n\n        <nz-form-control [nzSpan]=\"12\" nzErrorTip=\"必填\">\n          <input nz-input [formControlName]=\"i\" />\n        </nz-form-control>\n        <div nz-col [nzSpan]=\"2\">\n          <a nz-button nzType=\"link\" nzDanger (click)=\"remove(i)\">remove</a>\n        </div>\n      </nz-form-item>\n    </ng-container>\n\n    <nz-form-item>\n      <nz-form-control [nzOffset]=\"7\" [nzSpan]=\"12\">\n        <nz-space>\n          <button\n            *nzSpaceItem\n            nz-button\n            nzType=\"primary\"\n            (click)=\"markAsDirty()\"\n          >\n            markAsDirty\n          </button>\n\n          <button\n            *nzSpaceItem\n            nz-button\n            nzType=\"primary\"\n            (click)=\"markAsPristine()\"\n          >\n            markAsPristine\n          </button>\n          <button\n            *nzSpaceItem\n            nz-button\n            nzType=\"primary\"\n            (click)=\"markAsFullClean()\"\n          >\n            markAsFullClean\n          </button>\n\n          <button *nzSpaceItem nz-button (click)=\"patchValue()\">\n            pathValue\n          </button>\n          <button *nzSpaceItem nz-button (click)=\"logForm()\">logForm</button>\n        </nz-space>\n      </nz-form-control>\n    </nz-form-item>\n  </form>\n</nz-card>\n\n<nz-card nzTitle=\"函数式选择文件\">\n  <a nz-button nzType=\"link\" (click)=\"selectFile()\">选择单文件(jpg)</a>\n  <a nz-button nzType=\"link\" (click)=\"selectMultipleFile()\"\n    >选择多文件(图片，pdf)</a\n  >\n</nz-card>\n<nz-card nzTitle=\"文件下载\">\n  <img\n    *ngIf=\"imageUrl\"\n    [ngStyle]=\"{ border: '1px dashed #ccc', height: '150px', width: '150px' }\"\n    nz-image\n    [nzSrc]=\"imageUrl\"\n  />\n  <a nz-button nzType=\"link\" (click)=\"downloadFile()\">下载文件</a>\n</nz-card>\n"},{"path":"util/util.component.ts","content":"import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n} from '@angular/core';\nimport { NzMessageModule, NzMessageService } from 'ng-zorro-antd/message';\n\nimport { CommonModule } from '@angular/common';\nimport {\n  downloadFile,\n  selectFile,\n  updateControlStatus,\n} from 'ng-zorro-antd-extension/util';\nimport { NzButtonModule } from 'ng-zorro-antd/button';\nimport { NzCardModule } from 'ng-zorro-antd/card';\nimport { NzFormModule } from 'ng-zorro-antd/form';\nimport { NzImageModule } from 'ng-zorro-antd/image';\nimport {\n  AbstractControl,\n  FormArray,\n  FormBuilder,\n  FormGroup,\n  ReactiveFormsModule,\n  Validators,\n} from '@angular/forms';\nimport { NzInputModule } from 'ng-zorro-antd/input';\nimport { NzGridModule } from 'ng-zorro-antd/grid';\nimport { NzSpaceModule } from 'ng-zorro-antd/space';\n\n@Component({\n  selector: 'nzx-util-demo',\n  templateUrl: './util.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    NzGridModule,\n    NzFormModule,\n    NzButtonModule,\n    NzMessageModule,\n    NzCardModule,\n    NzImageModule,\n    NzInputModule,\n    NzSpaceModule,\n  ],\n})\nexport class NzxUtilExampleComponent {\n  imageUrl!: string;\n  form: FormGroup;\n\n  get aliases() {\n    return this.form.get('aliases') as FormArray;\n  }\n\n  private file!: File;\n  constructor(\n    private logger: NzMessageService,\n    private cd: ChangeDetectorRef,\n    private fb: FormBuilder\n  ) {\n    this.form = this.fb.group({\n      userName: ['', [Validators.required]],\n      address: this.fb.group({\n        street: ['', [Validators.required]],\n        city: ['', [Validators.required]],\n      }),\n      aliases: this.fb.array([]),\n    });\n  }\n\n  addAlias() {\n    this.aliases.push(this.fb.control('', [Validators.required]));\n  }\n\n  patchValue() {\n    this.form.reset({\n      userName: null,\n      address: {\n        street: null,\n        city: null,\n      },\n      aliases: [],\n    });\n    this.aliases.clear();\n\n    const aliases: string[] = ['zhangsan', ''];\n\n    for (let index = 0; index < aliases.length; index++) {\n      this.addAlias();\n    }\n\n    this.form.patchValue({\n      userName: 'enochgao',\n      address: {\n        street: '',\n        city: 'qingdao',\n      },\n      aliases,\n    });\n  }\n\n  markAsDirty(): void {\n    updateControlStatus(this.form);\n  }\n\n  markAsPristine() {\n    updateControlStatus(this.form, true);\n  }\n\n  markAsFullClean() {\n    updateControlStatus(this.form, true, (control: AbstractControl) => {\n      control.markAsUntouched();\n    });\n  }\n\n  remove(i: number) {\n    this.aliases.removeAt(i);\n  }\n\n  logForm() {\n    console.log('submit', this.form);\n  }\n\n  selectFile() {\n    selectFile('.jpg').subscribe((file) => {\n      console.log('单文件选择了', file);\n      this.logger.success(\n        `您选择了文件：${file?.name}，现在你可以进行下载文件了`,\n        {\n          nzDuration: 4000,\n        }\n      );\n\n      if (file) {\n        this.file = file;\n        this.imageUrl = URL.createObjectURL(file);\n        console.log('url', this.imageUrl);\n\n        this.cd.markForCheck();\n      }\n    });\n  }\n\n  selectMultipleFile() {\n    selectFile('image/*,.pdf', true).subscribe((files) => {\n      console.log('多文件选择了', files);\n    });\n  }\n\n  downloadFile() {\n    if (this.file) {\n      downloadFile(this.file, '测试文件');\n    } else {\n      this.logger.warning(`请先选择文件`);\n    }\n  }\n}\n"},{"path":"examples.module.ts","content":"import { NzxUtilExampleComponent } from './util/util.component';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n@NgModule({\n    declarations: [  ],\n    providers: [  ],\n    imports: [ CommonModule, NzxUtilExampleComponent ],\n    exports: [ NzxUtilExampleComponent ]\n})\nexport class NzxUtilExamplesModule {}\n"}]