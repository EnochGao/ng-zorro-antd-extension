[{"path":"configurable-query/config.ts","content":"import { FormControl, Validators } from '@angular/forms';\nimport { NzxQueryControlOptions } from 'ng-zorro-antd-extension/configurable-query/type';\n\nexport const controls: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n    controlInstance: new FormControl(null, [Validators.required]),\n    errorTip: '必填',\n  },\n  {\n    label: '占位',\n  },\n  {\n    controlName: 'gender',\n    label: '性别',\n    placeholder: '请选择',\n    controlType: 'select',\n    menuList: [\n      { label: '男', value: 1 },\n      { label: '女', value: 2 },\n    ],\n    nzxAllowClear: true,\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n    collapse: true,\n  },\n  {\n    controlName: 'level',\n    label: '职业等级',\n    controlType: 'Template',\n    collapse: true,\n  },\n];\n\nexport const controls2: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n  },\n];\n\nexport const controls3: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'gender',\n    label: '性别',\n    placeholder: '请选择',\n    controlType: 'select',\n    menuList: [\n      { label: '男', value: 1 },\n      { label: '女', value: 2 },\n    ],\n    controlInstance: new FormControl(1, [Validators.required]),\n    errorTip: '假设必填默认',\n    nzxAllowClear: true,\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n    collapse: true,\n  },\n  {\n    controlName: 'level',\n    label: '职业等级',\n    controlType: 'Template',\n    collapse: true,\n  },\n];\n\nexport const controls4: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n    nzxClass: 'test',\n  },\n  {\n    controlName: 'gender',\n    label: '性别',\n    placeholder: '请选择',\n    controlType: 'select',\n    menuList: [\n      { label: '男', value: 1 },\n      { label: '女', value: 2 },\n    ],\n    controlInstance: new FormControl(1, [Validators.required]),\n    errorTip: '假设必填默认',\n    nzxAllowClear: true,\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n    collapse: true,\n  },\n  {\n    controlName: 'level',\n    label: '职业等级',\n    controlType: 'Template',\n    collapse: true,\n  },\n];\n\nexport const controls5: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'searchType',\n    placeholder: '请选择',\n    nzxSpan: 3,\n    nzxRSpan: 24,\n    controlType: 'select',\n    menuList: [\n      { label: '班级', value: 1 },\n      { label: '姓名', value: 2 },\n    ],\n    default: 1,\n  },\n  {\n    controlName: 'searchKey',\n    placeholder: '搜索内容',\n    nzxSpan: 9,\n    nzxRSpan: 24,\n    controlType: 'input',\n  },\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'gender',\n    label: '性别',\n    placeholder: '请选择',\n    controlType: 'select',\n    menuList: [\n      { label: '男', value: 1 },\n      { label: '女', value: 2 },\n    ],\n    controlInstance: new FormControl(1, [Validators.required]),\n    errorTip: '假设必填默认',\n    nzxAllowClear: true,\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n    collapse: true,\n  },\n  {\n    controlName: 'level',\n    label: '职业等级',\n    controlType: 'Template',\n    collapse: true,\n  },\n];\n\nexport const controls6: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'searchType',\n    placeholder: '请选择',\n    nzxSpan: 3,\n    nzxRSpan: 24,\n    controlType: 'select',\n    menuList: [\n      { label: '班级', value: 1 },\n      { label: '姓名', value: 2 },\n    ],\n    default: 1,\n  },\n  {\n    controlName: 'searchKey',\n    placeholder: '搜索内容',\n    nzxSpan: 9,\n    nzxRSpan: 24,\n    controlType: 'input',\n  },\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n    collapse: true,\n  },\n  {\n    controlName: 'gender',\n    label: '性别',\n    placeholder: '请选择',\n    controlType: 'select',\n    menuList: [\n      { label: '男', value: 1 },\n      { label: '女', value: 2 },\n    ],\n    controlInstance: new FormControl(1, [Validators.required]),\n    errorTip: '假设必填默认',\n    nzxAllowClear: true,\n    collapse: true,\n  },\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n    collapse: true,\n  },\n  {\n    controlName: 'level',\n    label: '职业等级',\n    controlType: 'Template',\n    collapse: true,\n  },\n];\n\nexport const controls7: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'city',\n    label: '城市',\n    placeholder: '城市',\n    controlType: 'select',\n    menuList: [\n      { label: '青岛', value: '青岛' },\n      { label: '潍坊', value: '潍坊' },\n    ],\n  },\n];\n\nexport const controls8: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'city',\n    label: '城市',\n    placeholder: '城市',\n    controlType: 'select',\n    menuList: [\n      { label: '青岛', value: '青岛' },\n      { label: '潍坊', value: '潍坊' },\n    ],\n  },\n];\n\nexport const controls9: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n  {\n    controlName: 'city',\n    label: '城市',\n    placeholder: '城市',\n    controlType: 'select',\n    menuList: [\n      { label: '青岛', value: '青岛' },\n      { label: '潍坊', value: '潍坊' },\n    ],\n  },\n];\n\nexport const controls10: Array<NzxQueryControlOptions> = [\n  {\n    controlName: 'name',\n    label: '姓名',\n    placeholder: '姓名',\n    controlType: 'input',\n  },\n\n  {\n    controlName: 'birthday',\n    label: '出生日期',\n    placeholder: '日期',\n    controlType: 'datePicker',\n  },\n];\n"},{"path":"configurable-query/configurable-query.component.html","content":"<div class=\"container\">\n  <div>例子1： 自定义拓展查询职业等级,姓名必填</div>\n  <nzx-configurable-query\n    [controls]=\"controls\"\n    (queryChange)=\"queryParams = $event\"\n    (resetChange)=\"queryParams = $event\"\n  >\n    <ng-template nzxControl=\"level\" let-formControl>\n      <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams | json }}\n  </pre>\n\n  <div>例子2： 自动一行展示</div>\n  <nzx-configurable-query\n    [controls]=\"controls2\"\n    (queryChange)=\"queryParams2 = $event\"\n    (resetChange)=\"queryParams2 = $event\"\n  >\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams2 | json }}\n  </pre>\n\n  <div>例子3： 根据collapse属性自动展示折叠</div>\n  <nzx-configurable-query\n    [nzxBtnSpan]=\"24\"\n    [controls]=\"controls3\"\n    (queryChange)=\"queryParams3 = $event\"\n    (resetChange)=\"queryParams3 = $event\"\n  >\n    <ng-template nzxControl=\"level\" let-formControl>\n      <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams3 | json }}\n  </pre>\n\n  <div>例子4： 一行展示两个control</div>\n  <nzx-configurable-query\n    [controls]=\"controls4\"\n    [lineNumber]=\"2\"\n    [nzxBtnSpan]=\"24\"\n    (queryChange)=\"queryParams4 = $event\"\n    (resetChange)=\"queryParams4 = $event\"\n  >\n    <ng-template nzxControl=\"level\" let-formControl>\n      <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams4 | json }}\n  </pre>\n\n  <div>例子5： 简化查询</div>\n  <nzx-configurable-query\n    [controls]=\"controls5\"\n    [lineNumber]=\"2\"\n    [nzxBtnSpan]=\"24\"\n    (queryChange)=\"queryParams5 = $event\"\n    (resetChange)=\"queryParams5 = $event\"\n  >\n    <ng-template nzxControl=\"level\" let-formControl>\n      <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams5 | json }}\n  </pre>\n\n  <div>例子6： 初始化界面主动查询</div>\n  <nzx-configurable-query\n    [controls]=\"controls6\"\n    [lineNumber]=\"2\"\n    [initQuery]=\"true\"\n    (queryChange)=\"queryParams6 = $event\"\n    (resetChange)=\"queryParams6 = $event\"\n  >\n    <ng-template nzxControl=\"level\" let-formControl>\n      <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams6 | json }}\n  </pre>\n\n  <div>例子7： 模拟远程加载下拉</div>\n  <nzx-configurable-query\n    #query7\n    [controls]=\"controls7\"\n    [initQuery]=\"true\"\n    (queryChange)=\"queryParams7 = $event\"\n    (resetChange)=\"queryParams7 = $event\"\n  >\n    <ng-template nzxControl=\"pickerDate\" let-formControl>\n      <nz-range-picker\n        [nzAllowClear]=\"false\"\n        [nzStatus]=\"formControl.status === 'INVALID' ? 'error' : ''\"\n        [nzShowTime]=\"false\"\n        nzFormat=\"yyyy-MM-dd\"\n        [formControl]=\"formControl\"\n      ></nz-range-picker>\n    </ng-template>\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams7 | json }}\n  </pre>\n\n  <div>例子8：缺省固定参数</div>\n  <nzx-configurable-query\n    #query8\n    [controls]=\"controls8\"\n    [fixedParams]=\"{ enabled: true }\"\n    (queryChange)=\"queryParams8 = $event\"\n    (resetChange)=\"queryParams8 = $event\"\n  >\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams8 | json }}\n  </pre>\n\n  <div>例子9：缓存查询参数</div>\n  <nzx-configurable-query\n    #query9\n    [controls]=\"controls9\"\n    [initQuery]=\"true\"\n    [fixedParams]=\"{ enabled: true }\"\n    (queryChange)=\"queryChange($event)\"\n    (resetChange)=\"queryChange($event)\"\n  >\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams9 | json }}\n  </pre>\n\n  <div>例子10： 动态添加删除控件</div>\n  <nz-space>\n    <button\n      *nzSpaceItem\n      nz-button\n      nzType=\"primary\"\n      nzSize=\"small\"\n      (click)=\"addLevel()\"\n    >\n      add level to first\n    </button>\n    <button\n      *nzSpaceItem\n      nz-button\n      nzType=\"primary\"\n      nzSize=\"small\"\n      (click)=\"addGender()\"\n    >\n      add gender to second\n    </button>\n\n    <button\n      *nzSpaceItem\n      nz-button\n      nzType=\"primary\"\n      nzSize=\"small\"\n      (click)=\"removeLevel()\"\n    >\n      remove level\n    </button>\n    <button\n      *nzSpaceItem\n      nz-button\n      nzType=\"primary\"\n      nzSize=\"small\"\n      (click)=\"removeGender()\"\n    >\n      remove gender\n    </button>\n  </nz-space>\n\n  <ng-template #levelRef let-formControl>\n    <nz-rate [formControl]=\"formControl\" nzAllowHalf></nz-rate>\n  </ng-template>\n\n  <nzx-configurable-query\n    #query10\n    [controls]=\"controls10\"\n    (queryChange)=\"queryParams10 = $event\"\n    (resetChange)=\"queryParams10 = $event\"\n  >\n  </nzx-configurable-query>\n  <pre>\n  {{ queryParams10 | json }}\n  </pre>\n</div>\n"},{"path":"configurable-query/configurable-query.component.scss","content":".container {\n  padding: 20px;\n  background-color: #ccc;\n}\n"},{"path":"configurable-query/configurable-query.component.ts","content":"import { CommonModule } from '@angular/common';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  OnInit,\n  TemplateRef,\n  ViewChild,\n} from '@angular/core';\nimport {\n  AbstractControl,\n  FormControl,\n  ReactiveFormsModule,\n  ValidationErrors,\n  Validators,\n} from '@angular/forms';\nimport { NzRateModule } from 'ng-zorro-antd/rate';\nimport {\n  NzxConfigurableQueryComponent,\n  NzxConfigurableQueryModule,\n} from 'ng-zorro-antd-extension/configurable-query';\nimport {\n  NzxQueryControlOptions,\n  NzxQueryParams,\n} from 'ng-zorro-antd-extension/configurable-query/type';\nimport { NzButtonModule } from 'ng-zorro-antd/button';\nimport { NzSpaceModule } from 'ng-zorro-antd/space';\nimport {\n  controls,\n  controls10,\n  controls2,\n  controls3,\n  controls4,\n  controls5,\n  controls6,\n  controls7,\n  controls8,\n  controls9,\n} from './config';\nimport { NzDatePickerModule } from 'ng-zorro-antd/date-picker';\nimport { isArray } from 'ng-zorro-antd-extension/util';\nimport { differenceInCalendarDays, endOfMonth, startOfMonth } from 'date-fns';\n\n@Component({\n  selector: 'nzx-configurable-query-demo',\n  templateUrl: './configurable-query.component.html',\n  styleUrls: ['./configurable-query.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    NzRateModule,\n    NzxConfigurableQueryModule,\n    NzButtonModule,\n    NzSpaceModule,\n    NzDatePickerModule,\n  ],\n})\nexport class NzxConfigurableQueryExampleComponent implements OnInit {\n  queryParams: NzxQueryParams = {};\n  controls: Array<NzxQueryControlOptions> = controls;\n\n  queryParams2: NzxQueryParams = {};\n  controls2: Array<NzxQueryControlOptions> = controls2;\n\n  queryParams3: NzxQueryParams = {};\n  controls3: Array<NzxQueryControlOptions> = controls3;\n\n  queryParams4: NzxQueryParams = {};\n  controls4: Array<NzxQueryControlOptions> = controls4;\n\n  queryParams5: NzxQueryParams = {};\n  controls5: Array<NzxQueryControlOptions> = controls5;\n\n  queryParams6: NzxQueryParams = {};\n  controls6: Array<NzxQueryControlOptions> = controls6;\n\n  queryParams7: NzxQueryParams = {};\n  controls7: Array<NzxQueryControlOptions> = controls7;\n  @ViewChild('query7') private query7!: NzxConfigurableQueryComponent;\n\n  cityList = [\n    { label: '青岛', value: '青岛' },\n    { label: '潍坊', value: '潍坊' },\n    { label: '烟台', value: '烟台' },\n  ];\n\n  queryParams8: NzxQueryParams = {};\n  controls8: Array<NzxQueryControlOptions> = controls8;\n  @ViewChild('query8') private query8!: NzxConfigurableQueryComponent;\n\n  queryParams9: NzxQueryParams = {};\n  controls9: Array<NzxQueryControlOptions> = controls9;\n  @ViewChild('query9', { static: true })\n  private query9!: NzxConfigurableQueryComponent;\n\n  queryParams10: NzxQueryParams = {};\n  controls10: Array<NzxQueryControlOptions> = controls10;\n\n  @ViewChild('levelRef', { static: true })\n  private levelRef!: TemplateRef<any>;\n  @ViewChild('query10', { static: true })\n  private query10!: NzxConfigurableQueryComponent;\n\n  private pickerDateValidator = (\n    control: AbstractControl\n  ): ValidationErrors | null => {\n    const list = control.value;\n    if (isArray(list) && list.length === 2) {\n      const calculate = differenceInCalendarDays(list[1], list[0]);\n      if (calculate > 30) {\n        return { error: true };\n      }\n    }\n    return null;\n  };\n\n  addGender() {\n    this.query10.addControl(\n      {\n        controlName: 'gender',\n        label: '性别',\n        placeholder: '请选择',\n        controlType: 'select',\n        menuList: [\n          { label: '男', value: 1 },\n          { label: '女', value: 2 },\n        ],\n        controlInstance: new FormControl(1, [Validators.required]),\n        errorTip: '假设必填默认',\n        nzxAllowClear: true,\n      },\n      2\n    );\n  }\n\n  addLevel() {\n    this.query10.addControl(\n      {\n        controlName: 'level',\n        label: '职业等级',\n        controlType: 'Template',\n        templateRef: this.levelRef,\n        collapse: true,\n      },\n      1\n    );\n  }\n\n  removeLevel() {\n    this.query10.removeControl('level');\n  }\n  removeGender() {\n    this.query10.removeControl('gender');\n  }\n\n  ngOnInit(): void {\n    setTimeout(() => {\n      this.query7.setControl('city', { menuList: this.cityList });\n      this.query7.addControl({\n        controlName: 'pickerDate',\n        label: '时间',\n        nzxSpan: 6,\n        nzxLSpan: 8,\n        nzxRSpan: 16,\n        controlType: 'Template',\n        errorTip: '日期选择跨度不能超过31天',\n        controlInstance: new FormControl(\n          [startOfMonth(new Date()), endOfMonth(new Date())],\n          [this.pickerDateValidator]\n        ),\n      });\n    }, 3000);\n\n    const cacheStr = sessionStorage.getItem('cacheParams');\n    if (cacheStr) {\n      this.query9.setQueryParams(JSON.parse(cacheStr));\n    }\n    setTimeout(() => {\n      this.query9.setControl('city', { menuList: this.cityList });\n    }, 3000);\n  }\n\n  queryChange(params: NzxQueryParams) {\n    sessionStorage.setItem('cacheParams', JSON.stringify(params));\n    console.log(params);\n    this.queryParams9 = params;\n  }\n}\n"},{"path":"examples.module.ts","content":"import { NzxConfigurableQueryExampleComponent } from './configurable-query/configurable-query.component';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n@NgModule({\n    declarations: [  ],\n    providers: [  ],\n    imports: [ CommonModule, NzxConfigurableQueryExampleComponent ],\n    exports: [ NzxConfigurableQueryExampleComponent ]\n})\nexport class NzxConfigurableQueryExamplesModule {}\n"}]