[{"path":"page-table-basic/page-table-basic.component.html","content":"<nzx-configurable-query\r\n  #configQuery\r\n  [controls]=\"controls\"\r\n  (queryChange)=\"nzxTableAdaptorRef.refresh()\"\r\n  (resetChange)=\"nzxTableAdaptorRef.reset()\"\r\n>\r\n</nzx-configurable-query>\r\n\r\n<div>\r\n  <button type=\"button\" nz-button (click)=\"refresh()\">\r\n    操作后刷新列表到第一页\r\n  </button>\r\n  <button type=\"button\" nz-button (click)=\"refresh(true)\">\r\n    操作后刷新列表当前页\r\n  </button>\r\n</div>\r\n\r\n<nz-table\r\n  nzxTableAdaptor\r\n  [enableCache]=\"true\"\r\n  [queryParams]=\"configQuery.queryParams\"\r\n  expand\r\n  (nzxQueryParams)=\"loadData($event)\"\r\n  (nzxQueryCacheQueryParams)=\"configQuery.setQueryParams($event)\"\r\n  #nzTable\r\n  [nzData]=\"list\"\r\n  [nzLoading]=\"loading\"\r\n  [nzTotal]=\"nzTotal\"\r\n>\r\n  <thead>\r\n    <tr>\r\n      <th nzColumnKey=\"name\" [nzSortFn]=\"true\">姓名</th>\r\n      <th nzColumnKey=\"gender\" [nzFilters]=\"filterGender\" [nzFilterFn]=\"true\">\r\n        性别\r\n      </th>\r\n      <th nzColumnKey=\"nat\" [nzSortFn]=\"true\">国籍</th>\r\n      <th nzColumnKey=\"email\" [nzSortFn]=\"true\">Email</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let data of list\">\r\n      <td>{{ data.name.first }} {{ data.name.last }}</td>\r\n      <td>{{ data.gender }}</td>\r\n      <td>{{ data.nat }}</td>\r\n      <td>{{ data.email }}</td>\r\n    </tr>\r\n  </tbody>\r\n</nz-table>\r\n"},{"path":"page-table-basic/page-table-basic.component.ts","content":"import { Component } from '@angular/core';\r\n\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { NzButtonModule } from 'ng-zorro-antd/button';\r\nimport { NzTableModule } from 'ng-zorro-antd/table';\r\nimport { Observable, catchError, of } from 'rxjs';\r\n\r\nimport {\r\n  NzxConfigurableQueryModule,\r\n  NzxQueryControlOptions,\r\n} from 'ng-zorro-antd-extension/configurable-query';\r\nimport {\r\n  NzxTableAdaptorModule,\r\n  NzxTableQueryParams,\r\n} from 'ng-zorro-antd-extension/table-adaptor';\r\n\r\nimport { NzxPageTableBase } from 'ng-zorro-antd-extension/table-adaptor';\r\n\r\ninterface RandomUser {\r\n  gender: string;\r\n  email: string;\r\n  name: {\r\n    title: string;\r\n    first: string;\r\n    last: string;\r\n  };\r\n  nat: string;\r\n}\r\n\r\n@Component({\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    NzButtonModule,\r\n    NzTableModule,\r\n    NzxConfigurableQueryModule,\r\n    NzxTableAdaptorModule,\r\n  ],\r\n  selector: 'nzx-page-table-basic-example',\r\n  templateUrl: './page-table-basic.component.html',\r\n})\r\nexport class NzxPageTableBasicExampleComponent extends NzxPageTableBase<RandomUser> {\r\n  controls: Array<NzxQueryControlOptions> = [\r\n    {\r\n      controlName: 'nat',\r\n      label: '国籍',\r\n      placeholder: '国籍',\r\n      controlType: 'input',\r\n    },\r\n  ];\r\n\r\n  filterGender = [\r\n    { text: 'male', value: 'male' },\r\n    { text: 'female', value: 'female' },\r\n  ];\r\n\r\n  constructor(private http: HttpClient) {\r\n    super();\r\n  }\r\n\r\n  refresh(current: boolean = false) {\r\n    this.nzxTableAdaptorRef.refresh(current);\r\n  }\r\n\r\n  loadData(params: NzxTableQueryParams) {\r\n    console.log('查询参数', params);\r\n    this.loading = true;\r\n\r\n    this.getUsers(params).subscribe((data) => {\r\n      this.loading = false;\r\n      this.nzTotal = 200;\r\n      this.list = data.results;\r\n    });\r\n  }\r\n\r\n  private getUsers(\r\n    params: NzxTableQueryParams\r\n  ): Observable<{ results: RandomUser[] }> {\r\n    const { pageSize, pageIndex, sort, filter, nat } = params;\r\n    const currentSort = sort.find((item: any) => item.value !== null);\r\n    const sortField = (currentSort && currentSort.key) || null;\r\n    const sortOrder = (currentSort && currentSort.value) || null;\r\n\r\n    let httpParams = new HttpParams()\r\n      .append('page', `${pageIndex}`)\r\n      .append('results', `${pageSize}`)\r\n      .append('sortField', `${sortField}`)\r\n      .append('sortOrder', `${sortOrder}`)\r\n      .append('nat', `${nat}`);\r\n\r\n    filter.forEach((f) => {\r\n      f.value.forEach((value: any) => {\r\n        httpParams = httpParams.append(f.key, value);\r\n      });\r\n    });\r\n    return this.http\r\n      .get<{ results: RandomUser[] }>('https://api.randomuser.me/', {\r\n        params: httpParams,\r\n      })\r\n      .pipe(catchError(() => of({ results: [] })));\r\n  }\r\n}\r\n"},{"path":"table-adaptor/table-adaptor.component.html","content":"<nzx-configurable-query\r\n  #configQuery\r\n  [controls]=\"controls\"\r\n  (queryChange)=\"adaptor.refresh()\"\r\n  (resetChange)=\"adaptor.reset()\"\r\n>\r\n</nzx-configurable-query>\r\n\r\n<div>\r\n  <button type=\"button\" nz-button (click)=\"refresh()\">\r\n    操作后刷新列表到第一页\r\n  </button>\r\n  <button type=\"button\" nz-button (click)=\"refresh(true)\">\r\n    操作后刷新列表当前页\r\n  </button>\r\n</div>\r\n\r\n<nz-table\r\n  nzxTableAdaptor\r\n  #adaptor=\"NzxTableAdaptor\"\r\n  [enableCache]=\"true\"\r\n  [queryParams]=\"configQuery.queryParams\"\r\n  (nzxQueryParams)=\"loadData($event)\"\r\n  (nzxQueryCacheQueryParams)=\"configQuery.setQueryParams($event)\"\r\n  #nzTable\r\n  [nzData]=\"list\"\r\n  [nzLoading]=\"loading\"\r\n  [nzTotal]=\"total\"\r\n>\r\n  <thead>\r\n    <tr>\r\n      <th nzColumnKey=\"name\" [nzSortFn]=\"true\">姓名</th>\r\n      <th nzColumnKey=\"gender\" [nzFilters]=\"filterGender\" [nzFilterFn]=\"true\">\r\n        性别\r\n      </th>\r\n      <th nzColumnKey=\"nat\" [nzSortFn]=\"true\">国籍</th>\r\n      <th nzColumnKey=\"email\" [nzSortFn]=\"true\">Email</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let data of list\">\r\n      <td>{{ data.name.first }} {{ data.name.last }}</td>\r\n      <td>{{ data.gender }}</td>\r\n      <td>{{ data.nat }}</td>\r\n      <td>{{ data.email }}</td>\r\n    </tr>\r\n  </tbody>\r\n</nz-table>\r\n"},{"path":"table-adaptor/table-adaptor.component.ts","content":"import { Component, ViewChild } from '@angular/core';\r\n\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { NzButtonModule } from 'ng-zorro-antd/button';\r\nimport { NzTableModule } from 'ng-zorro-antd/table';\r\nimport { Observable, catchError, of } from 'rxjs';\r\n\r\nimport {\r\n  NzxConfigurableQueryModule,\r\n  NzxQueryControlOptions,\r\n} from 'ng-zorro-antd-extension/configurable-query';\r\nimport {\r\n  NzxTableAdaptor,\r\n  NzxTableAdaptorModule,\r\n  NzxTableQueryParams,\r\n} from 'ng-zorro-antd-extension/table-adaptor';\r\n\r\ninterface RandomUser {\r\n  gender: string;\r\n  email: string;\r\n  name: {\r\n    title: string;\r\n    first: string;\r\n    last: string;\r\n  };\r\n  nat: string;\r\n}\r\n\r\n@Component({\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    NzButtonModule,\r\n    NzTableModule,\r\n    NzxConfigurableQueryModule,\r\n    NzxTableAdaptorModule,\r\n  ],\r\n  selector: 'nzx-table-adaptor-example',\r\n  templateUrl: './table-adaptor.component.html',\r\n})\r\nexport class NzxTableAdaptorExampleComponent {\r\n  controls: Array<NzxQueryControlOptions> = [\r\n    {\r\n      controlName: 'nat',\r\n      label: '国籍',\r\n      placeholder: '国籍',\r\n      controlType: 'input',\r\n    },\r\n  ];\r\n\r\n  filterGender = [\r\n    { text: 'male', value: 'male' },\r\n    { text: 'female', value: 'female' },\r\n  ];\r\n\r\n  list: RandomUser[] = [];\r\n  loading = true;\r\n  total = 1;\r\n\r\n  @ViewChild('adaptor') private adaptorRef!: NzxTableAdaptor;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  refresh(current: boolean = false) {\r\n    this.adaptorRef.refresh(current);\r\n  }\r\n\r\n  loadData(params: NzxTableQueryParams) {\r\n    console.log('查询参数', params);\r\n    this.loading = true;\r\n\r\n    this.getUsers(params).subscribe((data) => {\r\n      this.loading = false;\r\n      this.total = 200;\r\n      this.list = data.results;\r\n    });\r\n  }\r\n\r\n  private getUsers(\r\n    params: NzxTableQueryParams\r\n  ): Observable<{ results: RandomUser[] }> {\r\n    const { pageSize, pageIndex, sort, filter, nat } = params;\r\n    const currentSort = sort.find((item: any) => item.value !== null);\r\n    const sortField = (currentSort && currentSort.key) || null;\r\n    const sortOrder = (currentSort && currentSort.value) || null;\r\n\r\n    let httpParams = new HttpParams()\r\n      .append('page', `${pageIndex}`)\r\n      .append('results', `${pageSize}`)\r\n      .append('sortField', `${sortField}`)\r\n      .append('sortOrder', `${sortOrder}`)\r\n      .append('nat', `${nat}`);\r\n\r\n    filter.forEach((f) => {\r\n      f.value.forEach((value: any) => {\r\n        httpParams = httpParams.append(f.key, value);\r\n      });\r\n    });\r\n    return this.http\r\n      .get<{ results: RandomUser[] }>('https://api.randomuser.me/', {\r\n        params: httpParams,\r\n      })\r\n      .pipe(catchError(() => of({ results: [] })));\r\n  }\r\n}\r\n"},{"path":"examples.module.ts","content":"import { NzxPageTableBasicExampleComponent } from './page-table-basic/page-table-basic.component';\nimport { NzxTableAdaptorExampleComponent } from './table-adaptor/table-adaptor.component';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n@NgModule({\n    declarations: [  ],\n    providers: [  ],\n    imports: [ CommonModule, NzxPageTableBasicExampleComponent, NzxTableAdaptorExampleComponent ],\n    exports: [ NzxPageTableBasicExampleComponent, NzxTableAdaptorExampleComponent ]\n})\nexport class NzxTableAdaptorExamplesModule {}\n"}]